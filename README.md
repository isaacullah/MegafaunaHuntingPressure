# MegafaunalHuntingPressure

## A model of human hunting pressure on a population of male and female animals in a possibly variable and dynamic environment. 

We employ the NetLogo Agent Based Modeling (ABM) platform (Wilensky, 1999) to simulate selective forager hunting preference on a sexually dimorphic prey species, where caloric returns can be modified to simulate a variety of handling costs and energy return rates. We use the logic of Optimal Foraging Theory (OFT) as a baseline for foraging behavior in the model; specifically, we implemented a spatial and time-transgressive version of the Diet Breadth model. Following the best practices of the Open Science movement (Marwick et al., 2017), we chose to reuse code from an existing peer-reviewed NetLogo simulation model of forager diet breadth (Barton, 2015). Barton’s (2015) model is derived from classic OFT (R. Foley, 1985), which is set up to test human foraging under various biological and environmental constraints under the assumption that foragers will always make the most optimal foraging decision in terms of caloric (or other “currency”) payoff when presented. We modified and expanded the base code of Barton’s (2015 ) Diet Breadth model to create an ABM “laboratory” within which to conduct experiments about the impact of human predation on large herbivores within an OFT framework that we call the “Megafauna Hunting Pressure” model. A screen capture of the graphical interface to our model and a link to the repository where the source code can be downloaded are in the Supplemental Material (S2)
3.1 The “Megafauna Hunting Pressure” Model 
The Megafauna Hunting Pressure model employs optimal foraging decision logic in a dynamic, complex adaptive systems implementation of the  diet breadth model  where males and females of a potentially sexually dimorphic, potentially k-selected prey species are the two available prey choices. In classic OFT, the payoff (or “profitability”), Pi , of a potential prey species i is described as the food energy Ei gained (e.g., in kcal) per unit time, ti, spent “processing” the prey once encountered (this includes the time to pursue, process, and eat the animal):

Pi = Ei / ti

Alternatively, profitability may be calculated as food energy gained minus energy costs expended handling (hi) the prey item, and so Equation 1 takes the form:

Pi = Ei - hi

To establish a “Diet Breadth” model, the profitability of all potential prey species must be known, as well as the average “search cost,” Si, required to find an individual prey animal of each species. To be included in the diet, the profitability of prey species k must exceed or equal the potential profitability of all other higher-ranked prey species (i to j) when search time is factored in:

Pk >= ΣPi⇒j - Si

Thus, if a first-ranked prey animal is encountered it is always pursued, processed, and eaten. If a lower-ranked prey animal is encountered, it is only pursued, processed, and eaten if the densities of all higher-ranked animals are low enough to offset the reduced payoff offered by the lower-ranked animal. This logic assumes the forager to know a priori the search time for all prey species within the entirety of the foraging environment, to always estimate these values correctly, and to never deviate from this decision logic. These issues are often cited as weaknesses of classical OFT. These critiques have been rebutted by showcasing OFT models as simply internally consistent baseline hypotheses against which to evaluate foraging datasets (Codding & Bird, 2015; Gremillion et al., 2014). In the Megafauna Hunting Pressure model, we combine OFT with a CAS perspective to move beyond these debates. Specifically, we leverage the spatiality and time-transgressive nature of the ABM modeling formalism to incorporate error and bias into the OFT decision logic in a way that may more realistically simulate foraging decisions. 
In our model, the foraging decision logic reflects a two-prey diet breadth model that also incorporates some assessment of possible future search costs in addition to prior “sunk” search costs. The two prey “species” (i.e., males and females) are parameterized with distinct intrinsic food energy payoff and handling costs that can be set independently in the model interface.  Optionally, an additional food energy value for calves can be added to that of recently postpartum females still rearing their offspring. In this way, Equation 2 may take one of the three forms when implemented in our model:


Pmales = Emales - hmales

Pfemales = Efemales - hfemales

Ppostpartum females = Efemales + Ecalves - hfemales


The forager agent will estimate an average search cost, Sa, by “scanning” within a pre-set foraging radius, r. This will first return a count of animals, n, within the foraging radius, as a proxy for the number of other prey that are likely to be nearby, and thus reasonable to consider as plausible alternative prey items. The forager agent then estimates an average search cost to keep looking for a nearby first-ranked prey by dividing the area within in the search radius (note that in the actual model code, area is measured as the cell count within the radius) by the number of prey that are within it, and then multiplying that by the forager movement cost, m:

Sa ≅ ( π r2 / n ) m

The average pay-off, Pa, of the animals (i to j) within the foraging radius is then calculated as:

Pa = ΣPi⇒j / rf

If the total payoff of the encountered animal is higher than the estimated return of searching for, encountering, and then processing one of the first ranked prey animals within the search radius, then the currently encountered lower-ranked animal is processed and eaten.


Pj >= Pa - Sa

Finally, if the forager is experiencing extreme food stress (Forager energy, Ef, less than the forager’s starvation threshold Estarve) they will process and eat any prey animal it encounters, no matter what (here, low energy is assumed to be a proxy for “sunk” search costs).

Ef < Estarve ⇒ Pi

So, in our model, the classic numerical Diet Breadth Model represented in Equation 3 is replaced by a dynamic and localized Diet Breadth Model represented by the situational chain of Equations 7 through 10.
The model contains a prey animal demography component as well. When a male and female prey agent occupy the same or adjacent landscape cells, a probabilistic algorithm determines if an offspring is produced based on a user-selectable reproduction rate and the current reproduction status of the female set by a birth spacing variable to reflect the time that females need to raise a calf before having another. Birth spacing is tracked by a counter variable that is set to zero when a female births a calf. If the counter is below the value set with a “birth spacing” slider, the female is considered “post-partum with calf,” and the calf food value will be added to the food value of the female.
	Once the post-partum female reaches the end of the birth spacing window, the calf is considered to be full grown. The female prey agent will then spawn a new prey agent in the same landscape cell. The new prey agent will be either male or female (0.5 probability of either) and will be instantiated with the food energy value and handling costs of the determined sex.
Births are balanced by a variety of causes of death. Prey animals are instantiated with initial energy states and lifespans and must graze grass to survive. Each movement step reduces an animal’s energy state by a user-determined amount, and each patch of grass encountered is grazed to replenish an animal’s energy by another user-determined amount. If an animal’s energy state drops below a user-defined “starvation threshold” there is a random chance of death from starvation, and if the energy state falls to 0 it will die. Likewise, as an animal approaches the user-determined maximum lifespan, there is an increasing probability of death from old age. There is also a stochastic external “mortality-curve” that can be adjusted to simulate a percentage of animals that die from disease, accidents, or non-human predation at each time-step. Finally, prey animals that are harvested by a forager are “killed” and removed from the simulation environment. Any form of death for a postpartum female within the birth spacing window also includes the death of the calf.
We incorporate realistic movement algorithms for forager and animal agents. Forager agents are programmed to move with some foraging information feedback as local conditions change. At each time step, forager agents will turn to face the closest, highest-ranked prey animal within their foraging radius, and then will advance one cell in that direction. If there are no nearby animals, then the forager proceeds in a true “random-walk” fashion. Animal agents are programmed to move as a herd, with some feedback about local grazing conditions.  At each time step, animals will first attempt to face the nearest patch of grass within a 3-cell radius and advance one cell in that direction. If there is no grass nearby, they will instead align their heading towards the average heading of animals that are within a 5-cell radius and advance one cell in that direction. If there are also no nearby animals, then the animal will proceed in a true “random-walk” fashion. An emergent property of these movement algorithms is that buffalo often self-organize into herds that will "migrate" in waves following the regrowth of grass patches (see next paragraph), while hunters often follow along in emergent “bands” of multiple foragers. 
Finally, the model has optional environmental dynamics components. Here, grass regrowth is simulated such that grazed patches become depleted of grass and remain depleted for a user-determined number of time-steps before it is replenished. The user can also predetermine a percentage of cells that are either grass or bare at the outset of the simulation. Users may also select for the initially bare patches to remain bare throughout the entire run of the model. Altogether, the environmental components are highly versatile and can fit a wide variety of user-determined scenarios. On one extreme, the effects of grazing can be completely offset by static and continual grass coverage on every patch. And at the other end of the spectrum, the environment can be set to extremely patchy grass that is grazed with a user determined rate of regrowth. 
In sum, the Megafauna Hunting Pressure model simulates human hunting pressure on a potentially sexually dimorphic, potentially k-selected prey species with a density-dependent breeding cycle in either a static or dynamic environment where both foragers and prey animals have some (limited and biased) information about local conditions that they use to plan their movement and subsistence decisions. Forager decisions are still based in optimality logic, but the information in the decision models is more realistic than classic numerical OFT modeling. There are feedback loops connecting the consequences of all potential decisions in a linked complex adaptive social-ecological system that create temporal and spatial dynamics not typically incorporated into OFT modeling.

This software is made available under the GNU GPL v3 license. Please cite the authors if you use this model or reuse the code.
